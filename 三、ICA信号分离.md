## 三、ICA信号分离

1. 将三幅图像混合在一起，得到三幅混合后的图像，分别采用三种不同的ICA方法进行图像恢复，并讨论分析。
2. 将三幅图像混合在一起，得到四幅混合后的图像，分别采用三种不同的ICA方法进行图像恢复，并与题一得到的结果进行比较
3. 将三个语音信号进混合在一起，得到三个混合后的语音信号，分别采用三种不同的ICA方法进行信号恢复，并讨论分析。
4. 将三个语音信号进混合在一起，得到四个混合后的语音信号，分别采用三种不同的ICA方法进行信号恢复，并与题三得到的结果进行比较。

由于上述四题都为ICA分离信号的问题，因此将它们合并在一起报告。

### 1. 基础知识

对于混合的信号，如果各信号独立，且如果在众多信号中，最多有一个分布为高斯分布的数据信号，我们可以使用独立元分析的方法将原信号进行解混。解混的思路就是使用各种方法（如统计特性、神经网络的负反馈等）使输出数据的独立性达到最大，此时就可以恢复出混合之前的信号，但是，恢复后的信号，在幅度和顺序上是随机的。

ICA主要分为两类方法：非目标函数和有目标函数的，分类主要如下

| 非目标函数   | 有目标函数   |
| ------- | ------- |
| H-J方法   | 最大熵法    |
| 四阶统计量方法 | 最小互信息法  |
| -       | 负熵法     |
| -       | FastICA |

然后，本次使用的方法为H-J方法、四阶统计量方法、最大熵法和FastICA法。

#### 1.1 H-J方法

H-J方法的核心是利用独立的定理：当$x$与$y$独立时，$E(f(x)g(y))=E(f(x))E(g(y))$，$f,g$为任意的函数。

其主要流程如下：

![H-J](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\报告用图\H-J.png)

$s_i$为源信号，$\mathbf{A}$为混合矩阵，$x_i$为混合后的信号，$\mathbf{W}$是$x_i$混合混阵，$y_i$是混合以后得到的值。它们的关系是：
$$
\mathbf{y}=\mathbf{x}-\mathbf{Wy}\\
\mathbf{x}=(I+\mathbf{W})\mathbf{y}\\
\mathbf{y}=(I+\mathbf{W})^{-1}\mathbf{x}
$$
权值的调整公式为：
$$
\frac{d\mathbf{w}}{dt}=\eta\mathbf{f(y)g(y)}\\
or\\
\frac{d\mathbf{w}}{dt}=\eta(I-\mathbf{f(y)g(y)})
$$
当$f(\cdot),g(\cdot)$为奇函数，当$\mathbf{y}$内部的各变量互相独立时，有$\frac{d\mathbf{w}}{dt}=0$。

其方法的步骤为：

1. 初始化权值$
2. 算出$\frac{d\mathbf{w}}{dt}$
3. 调整权值直到$\mathbf{w}$不变。
4. 得到分离后的信号$\mathbf{y}$

#### 1.2 白化

由于后面的方法都会用到白化处理，因此在这里先介绍一下什么是白化。

白化本质上是一个单位方差的PCA处理。

将每一路信号表示为$\mathbf{x}_i,i=1,2,\ldots,m$，$m$为观察到的信号的数量，源表示为$\mathbf{s}_i,i=1,2,\ldots,n$，则对$\mathbf{x}_i$的集合作协方差得到协方差矩阵$\mathbf{C}_x$，它的特征值按从大到小排序为$\lambda_1,\lambda_2,\ldots,\lambda_m$，对应的特征向量为$\mathbf{u}_1,\mathbf{u}_2,\ldots,\mathbf{u}_m$。对协方差矩阵进行SVD分解：
$$
\mathbf{C}_x=[\mathbf{u}_1,\mathbf{u}_2,\ldots,\mathbf{u}_m]diag(\lambda_1,\ldots,\lambda_m)[\mathbf{u}_1,\mathbf{u}_2,\ldots,\mathbf{u}_m]^T
$$
若$s_i$互相都是独立的，则所有特征值中，前n个特征值非零，若样本是无噪的，则后$m-n$个特征值为0，若有噪声，其方差为$\delta^2$，则后$m-n$个特征值为$\delta^2$。

那么由此就可从混合信号中观察到源信号的个数。

所以定义白化矩阵：
$$
\mathbf{M}=diag(\frac{1}{\sqrt{\lambda_1}},\frac{1}{\sqrt{\lambda_2}},\ldots,\frac{1}{\sqrt{\lambda_n}})[\mathbf{u}_1,\mathbf{u}_2,\ldots,\mathbf{u}_n]^T
$$
则白化过程即是混合后的信号左乘白化矩阵：
$$
\mathbf{z}=\mathbf{M}\mathbf{x}
$$
$\mathbf{z}$是白化后的信号。所以当源的数量与观察信号数量不一致，但方法要求他们一致时可以先白化再处理。

整个算法流程可以表示如下：

1. 将观察到的信号向量移除均值。


2. 求取协方差矩阵的特征值，并确定源的个数
3. 求取白化矩阵并白化观察信号，得到$\mathbf{z}$

由于实际过程中，样本总是带噪声的，因此对于白化过程的噪声方差要由先验知识进行调整。

#### 1.3 四阶统计量方法

该方法同样是无目标函数的ICA算法。其核心证明过程即是用四阶矩可以得到如下关系：
$$
\mathbf{A}=\mathbf{M}^{-1}\mathbf{B}   \\
\mathbf{s}=\mathbf{B}^T\mathbf{z}\\
$$
其中，$\mathbf{B}$为白化后信号$\mathbf{z}$的四阶矩的特征向量组成的矩阵 ，可由SVD分解得到。

流程为：

1. 先将观察的信号白化
2. 求白化后信号的四阶矩，进行SVD分解，得到特征向量组成的矩阵B。
3. 源信号即是$\mathbf{s}=\mathbf{B}^T\mathbf{x}$

#### 1.4 最大熵方法

这是一个有目标函数的ICA算法，利用信号独立时，信息熵最大这一性质，定义：
$$
y_i = f(u_i)\\
f(u_i)=\frac{1}{1+e ^{-u_i}}\\
u_i = \sum_{j=1}^mw_{i,j}x_j
$$
则向量$\mathbf{y}$的熵定义为：
$$
H(\mathbf{y})=-\int P_y(\mathbf{y})\log P_y(\mathbf{y})d\mathbf{y} = -E(\log P_y(\mathbf{y}))
$$
$P_y(\mathbf{y})$为概率密度函数。

则权值的调整公式即为：
$$
\Delta \mathbf{W}=\eta \frac{\partial H(\mathbf{y})}{\partial \mathbf{W}}=\eta((\mathbf{W}^T)^{-1}+(\mathbf{1}-2\mathbf{y}))
$$
$\mathbf{1}$为全1的向量。

其步骤为：

1. 初始化权值，随机选取$\mathbf{W}$
2. 算出$\mathbf{y}$。
3. 算出$\Delta \mathbf{W}$
4. 迭代直到$\Delta\mathbf{W}$不再变化。

#### 1.5 FASTICA方法

FastICA是有目标函数的ICA算法.

考虑单一神经元，令$\mathbf{x}$为白化后的零均值向量$\mathbf{z}$的样本，输入到该神经元。我们制定的基本学习规则为：“在神经元权值$\mathbf{w}$取$\Vert\mathbf{w}\Vert=1$的约束下，最大化$\mathbf{w}$对随机向量$\mathbf{z}$投影的负熵“，在该原则下，其目标函数是：
$$
F =E\{G_2(\mathbf{w}^T\mathbf{z})\}+\frac{1}{2}\beta\Vert \mathbf{w} \Vert
$$
权值调整公式为：
$$
\mathbf{w}_i(t)=E\{g_2(\mathbf{w}_i^T(t-1)\mathbf{z})\mathbf{z}  \}-E\{ g_2(\mathbf{w}_i^T(t-1)\mathbf{z}) \}\mathbf{w}_i(t-1)
$$
$G_2(\cdot)$是偶函数，一般取：


$$
G_2(y)=\frac{1}{a}\log(\cosh(ay)),a\in[1,2]\\
or\\
G_2(y)=-\exp(-\frac{y^2}{2})
\\
g_2(y)=\frac{\partial G_2(y)}{\partial y}\\
g_2(y)=a(1-\tanh^2(ay)),a\in[1,2]\\
g_2(y)=(1-y^2)\exp(-\frac{y^2}{2})
$$


其步骤为：

1. 对样本进行白化
2. 随机初始化神经元权值$\mathbf{w}_i(0)$并归一化
3. 计算$g_2(y)$并根据上述公式得到下一步的$\mathbf{w_i}(t)$并归一化
4. 正交化$\mathbf{w}_i(t)$
5. 如果$\mathbf{w}_i$不收敛，回到3。

### 2. 仿真方法

#### 2.1 分布分析

采用以上四种方法对图像的混合以及音频的混合结果进行解混。由于ICA要求只能有一个高斯分布，因此，先对信号进行四阶累积量分析：

| 图像   | 1        | 2         | 3        | 4         |
| ---- | -------- | --------- | -------- | --------- |
| kurt | 9.47e+06 | -9.34e+06 | 1.40e+06 | -4.33e+06 |

则图像信号为两个超高斯，两个亚高斯分布

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\风景图\1.bmp)

![2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\风景图\2.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\风景图\3.bmp)

![4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\风景图\4.bmp)

声音信号的四阶累计量普遍较小，可能和声音信号读取的时候进行了归一化有关，我们一般认为声音信号属于超高斯信号。

#### 2.2 解混的评价标准

对于图片，我们可以用之前用过的PSNR作为判断依据，同时，比较两个序列的相近程度，我们可以用皮尔逊相关系数来进行评价：
$$
r(X,Y)=\frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}}
$$
$Cov(\cdot)$是协方差，$Var(\cdot)$是方差。

当$r$越靠近1，则两者相关程度越大，信号也越相近。

因此用PSNR和相关系数作为评价标准。

#### 2.3 源信号的选取

本次仿真对于图片混合是从四张图中**随机选取三张图片**进行混合。对于音频信号，由于经过实验，不同种类的音频信号，长度与采样率都不同，混合时可能会出现问题，为了实验便利性考虑，**只使用同一类的音频**进行混合（实际实验中只使用了music类型的音频）。混合矩阵是随机产生并归一化过的。



###3.信号分离效果：

#### 3.1 问题1的结果（3幅图混3幅图）

##### 3.1.1 H-J方法结果：

混合后的图：

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\mix3.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\mix2.bmp)

分离后的图像：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\1.bmp)

![2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\2.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\hj\3.bmp)

可以看到，分离以后图的次序变成了3 1 2。

PSNR结果：

| 源图像     | 1     | 2     | 3     |
| ------- | ----- | ----- | ----- |
| PSNR/db | 18.46 | 21.63 | 18.13 |

相关系数的结果：

| 源图像/输出次序 | 1       | 2       | 3       |
| -------- | ------- | ------- | ------- |
| 1        | -0.2026 | -0.2080 | 0.9387  |
| 2        | 0.8385  | -0.4400 | -0.1544 |
| 3        | -0.1145 | 0.9568  | -0.2818 |

| 源图像/混合图像 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.1231 | 0.9825 | 0.1520 |
| 2        | 0.6682 | 0.3846 | 0.7088 |
| 3        | 0.5550 | 0.8150 | 0.2940 |

可以看到H-J的效果从肉眼观察并不好，但是其相关系数结果来看，还是将三幅图基本分开了，相比较混合图像，相关系数矩阵更集中了。同时，也可以用相关系数矩阵来辩别位置。

##### 3.1.2 四阶矩方法结果：

混合结果：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\mix3.bmp)

分离结果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\1.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\3.bmp)

![5](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\r4\5.bmp)

可以看到，分离以后图的次序变成了1 4 3。

PSNR结果：

| 源图像     | 1     | 3     | 4     |
| ------- | ----- | ----- | ----- |
| PSNR/db | 29.98 | 23.56 | 28.43 |

相关系数的结果：

| 源图像/输出次序 | 1       | 3       | 4      |
| -------- | ------- | ------- | ------ |
| 1        | 0.9776  | -0.0622 | 0.1141 |
| 2        | -0.1586 | -0.1737 | 0.9865 |
| 3        | 0.1379  | 0.9828  | 0.1171 |

| 源图像/混合图像 | 1      | 3      | 4      |
| -------- | ------ | ------ | ------ |
| 1        | 0.4436 | 0.9140 | 0.1354 |
| 2        | 0.6844 | 0.7078 | 0.2875 |
| 3        | 0.5102 | 0.5640 | 0.6416 |

从肉眼观察结果来看四阶矩效果比H-J要好很多，几乎看不到被混合的样子。从相关系数和PSNR也可以看出来，四阶矩方法要好于H-J。

##### 3.1.3 最大熵方法结果：

混合结果：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\mix3.bmp)

分离结果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\1.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\3.bmp)

![5](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\maxh\5.bmp)

可以看到，图片的顺序变为了2 3 4。

PSNR结果：

| 源图像     | 2     | 3     | 4     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 11.33 | 28.43 | 23.56 |

相关系数的结果：

| 源图像/输出次序 | 2       | 3      | 4       |
| -------- | ------- | ------ | ------- |
| 1        | 0.9745  | 0.1633 | 0.1130  |
| 2        | -0.1713 | 0.9800 | -0.1966 |
| 3        | -0.1449 | 0.1138 | 0.9739  |

| 源图像/混合图像 | 2      | 3      | 4      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6331 | 0.7050 | 0.2368 |
| 2        | 0.2979 | 0.9261 | 0.1390 |
| 3        | 0.8452 | 0.2757 | 0.4268 |

最大熵方法的效果看起来相比较四阶矩要差一些，但是相比较H-J要好一些。

##### 3.1.4 FASTICA方法

混合后图片：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\mix3.bmp)

分离后结果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\1.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\3.bmp)

![5](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\3-3\FASTICA\5.bmp)

输出图顺序为：1 3 2

PSNR结果：

| 源图像     | 1     | 2     | 3     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 32.61 | 43.94 | 38.11 |

相关系数的结果：

| 源图像/输出次序 | 2      | 3       | 4       |
| -------- | ------ | ------- | ------- |
| 1        | 0.9884 | -0.0358 | -0.0228 |
| 2        | 0.1265 | -0.0054 | 0.9995  |
| 3        | 0.0850 | 0.9993  | -0.0206 |

| 源图像/混合图像 | 2      | 3      | 4      |
| -------- | ------ | ------ | ------ |
| 1        | 0.1231 | 0.9825 | 0.1520 |
| 2        | 0.6682 | 0.3846 | 0.7088 |
| 3        | 0.5550 | 0.8150 | 0.2940 |

FastICA效果可以看到和四阶矩一样，非常优秀，肉眼完全看不到混合。从相关系数和PSNR来看，FastICA效果甚至要好于四阶矩。

##### 3.1.5 小结

从上面来看，效果为：
$$
\text{FASTICA}>\text{四阶矩}\gg \text{最大熵}>\text{H-J}
$$
前两者用肉眼几乎看不出区别，后两者则能看出还有信号混合的迹像。



#### 3.2 问题二的结果（4幅分3幅）

此问题的一个重点在于，像H-J和最大熵要求输入信号和源信号数目要相等，则要在输入算法前先将输入变量白化。

#####  3.2.1 H-J算法效果

混合图像：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\mix3.bmp)

![mix4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\mix4.bmp)

分离效果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\1.bmp)

![2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\2.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\hj\3.bmp)

输出图像顺序：4 2 3

PSNR结果：

| 源图像     | 2     | 3     | 4     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 15.24 | 16.62 | 20.65 |

相关系数的结果：

| 源图像/输出次序 | 2       | 3       | 4       |
| -------- | ------- | ------- | ------- |
| 1        | -0.2991 | -0.0709 | 0.9523  |
| 2        | 0.8215  | 0.2961  | -0.4908 |
| 3        | -0.5007 | 0.8307  | -0.3344 |

| 源图像/混合图像 | 2      | 3      | 4      |
| -------- | ------ | ------ | ------ |
| 1        | 0.5428 | 0.4789 | 0.6490 |
| 2        | 0.8460 | 0.4991 | 0.0838 |
| 3        | 0.6355 | 0.5227 | 0.5194 |
| 4        | 0.4859 | 0.8406 | 0.1367 |

可以看到，H-J出来的结果这次比较差，主要原因是因为迭代也没有收敛。但是从相关系数的表现来说，我们可以看到分离还是有成效的。

##### 3.2.2 四阶矩方法

混合图像：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\mix3.bmp)

![mix4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\mix4.bmp)

分离图像：

![2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\2.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\3.bmp)

![4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\r4\4.bmp)

输出图片顺序为：4 3 1

PSNR结果：

| 源图像     | 1     | 3     | 4     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 29.98 | 28.43 | 23.56 |

相关系数的结果：

| 源图像/输出次序 | 1       | 3       | 4      |
| -------- | ------- | ------- | ------ |
| 1        | -0.1586 | -0.1737 | 0.9865 |
| 2        | 0.1379  | 0.9828  | 0.1171 |
| 3        | 0.9776  | -0.0622 | 0.1141 |

| 源图像/混合图像 | 1      | 3      | 4      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6509 | 0.3240 | 0.6775 |
| 2        | 0.8354 | 0.3642 | 0.4305 |
| 3        | 0.1581 | 0.1876 | 0.9550 |
| 4        | 0.4931 | 0.8174 | 0.3409 |

可以看到，当四阶矩的效果还是一如既往的好。依旧是用肉眼无法看到混叠的效果。

##### 3.2.3 最大熵方法

混合图像：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\mix3.bmp)

![mix4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\mix4.bmp)

分离效果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\1.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\3.bmp)

![5](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\maxh\5.bmp)

输出图像顺序为：2 3 1

PSNR结果：

| 源图像     | 1     | 2     | 3     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 27.89 | 17.07 | 15.97 |

相关系数的结果：

| 源图像/输出次序 | 1       | 2       | 3      |
| -------- | ------- | ------- | ------ |
| 1        | -0.0155 | 0.8819  | 0.4370 |
| 2        | -0.2554 | -0.4676 | 0.8354 |
| 3        | 0.9667  | -0.0597 | 0.3333 |

| 源图像/混合图像 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.1573 | 0.2110 | 0.9707 |
| 2        | 0.3992 | 0.5177 | 0.7904 |
| 3        | 0.3793 | 0.3681 | 0.8797 |
| 4        | 0.3118 | 0.8116 | 0.5213 |

最大熵方法的在这个场景下不尽如人意，主要原因也是因为迭代了没收敛。

##### 3.2.4 FASTICA方法

混合图像：

![mix1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\mix1.bmp)

![mix2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\mix2.bmp)

![mix3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\mix3.bmp)

![mix4](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\mix4.bmp)

分离结果：

![1](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\4.bmp)

![2](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\2.bmp)

![3](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\4-3\FASTICA\6.bmp)

输出顺序为1 3 2

PSNR结果：

| 源图像     | 1     | 2     | 3     |
| ------- | :---- | ----- | ----- |
| PSNR/db | 32.61 | 36.35 | 38.04 |

相关系数的结果：

| 源图像/输出次序 | 1      | 2       | 3       |
| -------- | ------ | ------- | ------- |
| 1        | 0.9884 | -0.0358 | -0.0228 |
| 2        | 0.1296 | 0.0317  | 0.9980  |
| 3        | 0.0799 | 0.9988  | -0.0589 |

| 源图像/混合图像 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6092 | 0.6072 | 0.5839 |
| 2        | 0.6352 | 0.5301 | 0.6349 |
| 3        | 0.9848 | 0.2140 | 0.1415 |
| 4        | 0.4581 | 0.7790 | 0.4858 |

FASTICA效果也和之前一样好，完全看不出混叠。

##### 3.2.5 小结

从上面来看，效果为：
$$
\text{FASTICA}>\text{四阶矩}\gg \text{最大熵}\approx \text{H-J}
$$
前两者用肉眼几乎看不出区别，后两者则能看出还有信号混合的迹像。

而且相比较三幅图的结果，FASTICA和四阶矩基本没有什么变化，但是H-J和最大熵的效果变得更差了，这主要是因为相比较三幅图，四幅图白化后的结果更难以收敛，而实际计算当中，两者都设置了迭代上限，往往都是超过上限还无法收敛。



#### 3.3 第三问的结果（3声音分3声音）

声音文件存于ICA/result文件夹中，由于从声音波形也很难看出结果，因此主要观察相关系数。

源声音：

![源文件](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\报告用图\源文件.png)

##### 3.3.1 H-J 算法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\hj\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\hj\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1      | 2       | 3       |
| -------- | ------ | ------- | ------- |
| 1        | 0.9911 | 0.0368  | -0.1275 |
| 2        | 0.1217 | 0.2882  | 0.9504  |
| 3        | 0.0797 | -0.9325 | 0.3504  |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6557 | 0.0989 | 0.7484 |
| 2        | 0.6951 | 0.0143 | 0.7186 |
| 3        | 0.6155 | 0.2626 | 0.7430 |

可以看到出现了负相关，但是声音听起来是没有影响的，主要是因为反相不影响声音的频谱。但是听起来，H-J并没有把声音很好的分离，仍能听到一些其他文件的声音。

##### 3.3.2 四阶矩方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\r4\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\r4\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1       | 2       | 3       |
| -------- | ------- | ------- | ------- |
| 1        | 0.9988  | 0.0043  | 0.0478  |
| 2        | -0.0480 | -0.0098 | 0.9988  |
| 3        | 0.0079  | -0.9999 | -0.0123 |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.7079 | 0.0647 | 0.7031 |
| 2        | 0.8734 | 0.2162 | 0.4354 |
| 3        | 0.1686 | 0.0434 | 0.9848 |

四阶矩的结果相比较H-J有了巨大的提高，可以看到相关系数也都达到0.99以上，同时听起来完全听不见其他文件的声音

##### 3.3.3 最大熵方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\maxh\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\maxh\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1       | 2       | 3       |
| -------- | ------- | ------- | ------- |
| 1        | 0.4704  | 0.8567  | 0.2076  |
| 2        | -0.8163 | 0.5142  | -0.2664 |
| 3        | -0.3351 | -0.0405 | 0.9412  |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6860 | 0.0610 | 0.7248 |
| 2        | 0.8875 | 0.4156 | 0.1941 |
| 3        | 0.1712 | 0.1445 | 0.9749 |

最大熵方法的效果和H-J相差不多。听起来声音仍是混的，相关系数也都没有达到0.99。

##### 3.3.4 FASTICA方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\fastica\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio3-3\fastica\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1      | 2       | 3       |
| -------- | ------ | ------- | ------- |
| 1        | 0.0114 | 0.0040  | -0.9999 |
| 2        | 0.0050 | -1.0000 | -0.0069 |
| 3        | 0.9999 | 0.0019  | 0.0113  |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6793 | 0.1437 | 0.7194 |
| 2        | 0.7219 | 0.2396 | 0.6488 |
| 3        | 0.4879 | 0.0733 | 0.8698 |

FASTICA效果非常优秀，可以看到相关系数全是0.9999以上，同时，听起来也完全没有其他声音混合的效果。

##### 3.3.5 小结

从上面来看，效果为：
$$
\text{FASTICA}>\text{四阶矩}\gg \text{最大熵}\approx \text{H-J}
$$
前两者听不出其他声音混合，后两者则能听出还有信号混合的迹像。同时，因为相关系数上FASTICA表现好于四阶矩，因此认为FASTICA效果更好。

#### 3.4 第四题结果 （4声音取3声音）

##### 3.4.1 H-J算法效果

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\hj\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\hj\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1       | 2       | 3       |
| -------- | ------- | ------- | ------- |
| 1        | 0.0608  | -0.9800 | 0.1877  |
| 2        | -0.1888 | -0.9626 | 0.1888  |
| 3        | 0.0717  | 0.9464  | -0.3118 |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.6557 | 0.0989 | 0.7484 |
| 2        | 0.6951 | 0.0143 | 0.7186 |
| 3        | 0.6155 | 0.2626 | 0.7430 |
| 4        | 0.6936 | 0.0805 | 0.7156 |

H-J在这里的效果变得非常非常差，可以看到相关系数集中同一列了，说明H-J完全没有收敛。听起来的效果也是三个分开的文件听起来一样。

##### 3.4.2 四阶矩方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\r4\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\r4\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1      | 2       | 3       |
| -------- | ------ | ------- | ------- |
| 1        | 0.9988 | 0.0043  | 0.0478  |
| 2        | 0.0480 | 0.0098  | -0.9988 |
| 3        | 0.0079 | -0.9999 | -0.0123 |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.4503 | 0.0971 | 0.8876 |
| 2        | 0.8911 | 0.0855 | 0.4451 |
| 3        | 0.0044 | 0.9741 | 0.2286 |
| 4        | 0.9305 | 0.1241 | 0.3437 |

四阶矩方法的效果还是一样的好，没有听出声音混合的迹象。相关系数也还是和之前一样，都在0.99以上。

##### 3.4.3 最大熵方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\maxh\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\maxh\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1       | 2       | 3       |
| -------- | ------- | ------- | ------- |
| 1        | -0.2344 | -0.9229 | -0.3057 |
| 2        | 0.6064  | -0.3846 | 0.6958  |
| 3        | 0.7598  | 0.0182  | -0.6500 |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.8757 | 0.0282 | 0.4817 |
| 2        | 0.9551 | 0.0206 | 0.2952 |
| 3        | 0.7783 | 0.0892 | 0.6213 |
| 4        | 0.0717 | 0.1664 | 0.9839 |

最大熵的效果也很差，可以看到除了第一个输出，后两个输出基本是1和3的混合，还是没有被分离。听起来也和这里的结果一样。

##### 3.4.4 FASTICA方法

混合信号：

![混合](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\fastica\混合.png)

分离信号：

![分离](E:\17年学习\神经网络\神经网络作业二\NN_second_homework\ICA\result\audio4-3\fastica\分离.png)

相关系数的结果：

| 源声音/输出次序 | 1       | 2       | 3      |
| -------- | ------- | ------- | ------ |
| 1        | -0.0114 | -0.0040 | 0.9999 |
| 2        | -0.0050 | 1.0000  | 0.0069 |
| 3        | 0.9999  | 0.0019  | 0.0113 |

| 源声音/混合声音 | 1      | 2      | 3      |
| -------- | ------ | ------ | ------ |
| 1        | 0.9283 | 0.2622 | 0.2612 |
| 2        | 0.7517 | 0.1896 | 0.6313 |
| 3        | 0.2396 | 0.0420 | 0.9700 |
| 4        | 0.7649 | 0.0642 | 0.6407 |

FASTICA的效果和之前一样，非常好，相关系数都在0.9999以上，而且听不出混叠的声音。

##### 3.4.5 小结

从上面来看，效果为：
$$
\text{FASTICA}>\text{四阶矩}\gg \text{最大熵}\approx \text{H-J}
$$
前两者听不出其他声音混合，后两者则在这个情况下几乎没能分离信号。同时，因为相关系数上FASTICA表现好于四阶矩，因此认为FASTICA效果更好。



### 4. 总结

从上面四个问题的仿真结果来看，四种方法的效果是：
$$
\text{FASTICA}>\text{四阶矩}\gg \text{最大熵}\approx \text{H-J}
$$
而运行时间则是：
$$
\text{H-J}>\text{最大熵}\gg \text{四阶矩}\approx \text{FASTICA}
$$
可以看到H-J方法和最大熵方法效果都不尽如人意，对于图像分离还好，对于声音分离效果非常不好。同时，H-J和最大熵方法对于观测数大于源信号数的结果都不如两者相等时的结果好。可能是因为两者对于白化后的信号需要更多的迭代次数。同时运算速度上，H-J也要慢上许多。总的来说四阶矩和FASTICA是非常优秀的ICA算法，运行速度快且效果好。而H-J与最大熵则需要更多次数的迭代来取得好最好的效果。
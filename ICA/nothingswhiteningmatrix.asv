function [ M,Z ] = nothingswhiteningmatrix( X )
%输入样本X，输出M为白化矩阵
%   X为观测样本，一行为一个样本。
noise = 0;
[numx,~]=size(X);
X = X';
x1 = X - mean(X);
Cx = cov(x1);
[V D] = eig(Cx);
D1 = diag(D);
[newd, ix] = sort(D1, 'descend');
V = V(:,ix);
D1 = D1(ix);
[n,~] = size(find(diag(D)>noise));
V = V(:,1:n);
M = diag(1./sqrt(D1(1:n)))*V';
Z = M * X';

end

